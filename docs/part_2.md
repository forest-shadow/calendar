# Домашнее задание. Часть 2

Итоговый результат описан в [ТЗ](calendar.md).

В этой части задания мы непосредственно напишем бизнес-логику приложения.
Для этого реализуем:
- слой хранения, выполняющий запросы к БД и сохранение сущностей
- хендлеры, принимающие входящие http-запросы
- фоновые процессы для работы с приложением

### Слой хранения
Т.к. в `go` непринято использовать ORM, то обычно миграции (изменение схемы базы данных) пишутся отдельно и применяются к схеме базы данных отдельными утилитами в ручную или при старте приложения.

Разработайте миграции для таблицы событий и напишите в makefile таргет(команду makefile'а) для накатки миграций.

Дополнительно можно добавить накатку миграций при старте приложения (обычно делается только в dev-окружении).

Создать отдельный пакет, отвечающий за работу с хранилищем и выполняющий операции:
- добавление события в хранилище;
- изменение события в хранилище;
- удаление события из хранилища;
- листинг событий;

Для обращения к БД используйте компонент, созданный в первой части задания.

**Использовать ORM (например, gorm) не допускается.**

### Слой с бизнес-логикой
В крупных приложения, когда правил очень много, выделяют отдельный слой с бизнес-логикой - services или use-cases.

В нашем приложении в нем нет необходимости. Но мы должны спрятать слой хранения за интерфейсом, чтобы в дальнейшем можно было легко добавить новые правила.

Обычно интерфейс репозитория располагается в пакете со структурой, представляющую сущность.

### Хендлеры
Для маленьких приложений хендлеры представляют собой методы компонента `Handlers`. В них содержится только часть преобразования запроса в модели предметной области (события) и структур приложения в ответ http-запроса.

Необходимо реализовать endpoint'ы для выполнения всех операций API.

Вызов операций со слоем хранения должен происходить через интерфейс.

### Фоновые задания

Любое фоновое задание преcтавляет собой компонент приложения, при создании которого запускается горутина, выполяющая бизнес-логику.

Для переиодического запуска обычно используется `time.Ticker`. 

Периодичность фоновых заданий должна настраиваться через конфигурацию приложения.

### Критерии приемки задачи

* Написан слой хранения и основные операции в БД **- 2 балла**
* Написан слой services/use-cases **- 1 балл**
* Написаны миграции и добавлена отдельная команда в Makefile **- 1 балл**
* Написаны работающие HTTP API endpoints **- 3 балла**
* Понятность и чистота кода - **- до 2 баллов**
* Написаны фоновые задачи (cron-jobs) **- 2 балла**

Зачет от **7 баллов**
